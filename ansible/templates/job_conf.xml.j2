<?xml version="1.0"?>
<job_conf>
    <plugins workers="2">
        <plugin id="local" type="runner" load="galaxy.jobs.runners.local:LocalJobRunner"/>
        {% for destination in destinations %}
            <plugin id="{{ destination.name|lower }}_runner" type="runner" load="galaxy.jobs.runners.pulsar:{{ destination.type }}">
                <param id="galaxy_url">{{ galaxy_instance_url }}</param>
                <param id="amqp_url">{{ destination.amqp_url }}</param>
                 <param id="manager">production</param>
            </plugin>
        {% endfor %}
    </plugins>
    <destinations default="local">
        <destination id="dynamic_runner" runner="dynamic">
          <param id="type">python</param>
          <param id="function">dynamic_destination</param>
        </destination>
        <destination id="local" runner="local" />
        {% for destination in destinations %}
            <destination id="pulsar_{{ destination.name|lower }}" runner="{{ destination.name|lower }}_runner">
                <param id="jobs_directory">{{ destination.jobs_directory_dir }}</param>
                <param id="persistence_directory">{{ destination.persistence_dir }}</param>
                {% for key, value in destination.job_conf_params.items() %}
                    <param id="{{ key }}">{{ value }}</param>
                {% endfor %}
            </destination>
        {% endfor %}
    </destinations>
    <tools>
        <tool id="upload1" destination="local" />
        <tool id="__SET_METADATA__" destination="local" />
        <tool id="toolshed.g2.bx.psu.edu/repos/iuc/snpeff/snpEff_download/4.1.0" destination="local" />
        <tool id="toolshed.g2.bx.psu.edu/repos/iuc/snpeff/snpEff_download/4.3r.1" destination="local" />
        <tool id="toolshed.g2.bx.psu.edu/repos/bgruening/prepare_ligands_for_docking/prepare_ligands_for_docking/2.4.2.0" destination="local" />
        <tool id="toolshed.g2.bx.psu.edu/repos/bgruening/autodock_vina/docking/0.2.1" destination="dynamic_runner" />
    </tools>
</job_conf>
